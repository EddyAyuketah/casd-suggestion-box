PS C:\Users\eddyayuk\OneDrive - Intel Corporation\Desktop\Projects\FIST> & "C:/Users/eddyayuk/My Programs/SQLPathFinder3/Python3/python.exe" "c:/Users/eddyayuk/OneDrive - Intel Corporation/Desktop/Projects/CERT_LOT/Untitled-3.py"
✓ LineView loaded: 4349 operations, updated 0.2h ago
c:\Users\eddyayuk\OneDrive - Intel Corporation\Desktop\Projects\CERT_LOT\Untitled-3.py:80: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  quarter_ships_df = pd.read_sql(quarter_ships_sql, PyUber.connect('F32_PROD_XEUS'))
❌ Database error: Execution failed on sql '
SELECT
  SUM(WAFER_QTY) as total_wafers,
  COUNT(DISTINCT LOT) as lot_count,
  MAX(OUT_DATE) as last_ship_date,
  MIN(OUT_DATE) as first_ship_date
FROM
  F_LOT_RUN_CARD
WHERE
  OUT_DATE >= TO_DATE('09/06/2025 18:00', 'MM/DD/YYYY HH24:MI')
  AND OUT_DATE <= SYSDATE
  AND LOT_TYPE IN ('PROD', 'ENG')
  AND LOT LIKE 'L%'
  AND LOT NOT LIKE 'L9%'  -- Exclude test/qualification lots
  AND OPERATION = 185006
  AND WAFER_QTY > 0
  AND DISPOSITION_CODE IN ('PASS', 'SHIP')  -- Only count good wafers
': ('[UniqeServer] [Type:IBM DB2] ERROR [42703] [IBM][DB2/LINUXX8664] SQL0206N  "DISPOSITION_CODE" is not valid in the context where it is used. [F32_PROD_DIS_LOCAL:DB2]\r\nORA-00904: "DISPOSITION_CODE": invalid identifier [F32_PROD_XEUS:ODP2]',)
Traceback (most recent call last):
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\PyUber\core.py", line 182, in _activate
    self._columncount = t.column_count
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\PyUber\_uCLR.py", line 182, in column_count
    self._column_count = self.UniqeTable.ColumnCount
System.Exception: [UniqeServer] [Type:IBM DB2] ERROR [42703] [IBM][DB2/LINUXX8664] SQL0206N  "DISPOSITION_CODE" is not valid in the context where it is used. [F32_PROD_DIS_LOCAL:DB2]
ORA-00904: "DISPOSITION_CODE": invalid identifier [F32_PROD_XEUS:ODP2]

Server stack trace:
   at Intel.FabAuto.ESFW.DS.UBER.Uniqe.Core.Table.WaitUntilDataAvailable()
   at Intel.FabAuto.ESFW.DS.UBER.Uniqe.Core.Table.GetColumnNames()
   at System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Object[]& outArgs) 
   at System.Runtime.Remoting.Messaging.StackBuilderSink.AsyncProcessMessage(IMessage msg, IMessageSink replySink)

Exception rethrown at [0]:
   at System.Runtime.Remoting.Proxies.RealProxy.EndInvokeHelper(Message reqMsg, Boolean bProxyCase)
   at System.Runtime.Remoting.Proxies.RemotingProxy.Invoke(Object NotUsed, MessageData& msgData)
   at System.Func`2.EndInvoke(IAsyncResult result)
   at Intel.FabAuto.ESFW.DS.UBER.Uniqe.QEClient.UniqeClientPrivate.Invoke[T](Func`2 function, TimeSpan timeout, String timeOutMessage)      
   at Intel.FabAuto.ESFW.DS.UBER.Uniqe.QEClient.UberTable.CheckForTimeOut[T](Func`1 function)
   at Intel.FabAuto.ESFW.DS.UBER.Uniqe.QEClient.UberTable.GetColumns(Boolean originalColumns)
   at Intel.FabAuto.ESFW.DS.UBER.Uniqe.QEClient.UberTable.get_ColumnCount()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\pandas\io\sql.py", line 2018, in execute
    cur.execute(*args, **kwargs)
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\PyUber\core.py", line 123, in execute
    self._submit(query, parameters, datasource, _activate)
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\PyUber\core.py", line 148, in _submit
    self._activate() if _activate else None
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\PyUber\core.py", line 184, in _activate
    raise DatabaseError(self.be.apiexmsg(e))
PyUber.exceptions.DatabaseError: ('[UniqeServer] [Type:IBM DB2] ERROR [42703] [IBM][DB2/LINUXX8664] SQL0206N  "DISPOSITION_CODE" is not valid in the context where it is used. [F32_PROD_DIS_LOCAL:DB2]\r\nORA-00904: "DISPOSITION_CODE": invalid identifier [F32_PROD_XEUS:ODP2]',)    

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\eddyayuk\OneDrive - Intel Corporation\Desktop\Projects\CERT_LOT\Untitled-3.py", line 80, in <module>
    quarter_ships_df = pd.read_sql(quarter_ships_sql, PyUber.connect('F32_PROD_XEUS'))
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\pandas\io\sql.py", line 564, in read_sql
    return pandas_sql.read_query(
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\pandas\io\sql.py", line 2078, in read_query
    cursor = self.execute(*args)
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\pandas\io\sql.py", line 2030, in execute
    raise ex from exc
pandas.errors.DatabaseError: Execution failed on sql '
SELECT
  SUM(WAFER_QTY) as total_wafers,
  COUNT(DISTINCT LOT) as lot_count,
  MAX(OUT_DATE) as last_ship_date,
  MIN(OUT_DATE) as first_ship_date
FROM
  F_LOT_RUN_CARD
WHERE
  OUT_DATE >= TO_DATE('09/06/2025 18:00', 'MM/DD/YYYY HH24:MI')
  AND OUT_DATE <= SYSDATE
  AND LOT_TYPE IN ('PROD', 'ENG')
  AND LOT LIKE 'L%'
  AND LOT NOT LIKE 'L9%'  -- Exclude test/qualification lots
  AND OPERATION = 185006
  AND WAFER_QTY > 0
  AND DISPOSITION_CODE IN ('PASS', 'SHIP')  -- Only count good wafers
': ('[UniqeServer] [Type:IBM DB2] ERROR [42703] [IBM][DB2/LINUXX8664] SQL0206N  "DISPOSITION_CODE" is not valid in the context where it is used. [F32_PROD_DIS_LOCAL:DB2]\r\nORA-00904: "DISPOSITION_CODE": invalid identifier [F32_PROD_XEUS:ODP2]',)
PS C:\Users\eddyayuk\OneDrive - Intel Corporation\Desktop\Projects\FIST> 
