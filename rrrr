PS C:\Users\eddyayuk> & "C:/Users/eddyayuk/My Programs/SQLPathFinder3/Python3/python.exe" //shuser-prod.intel.com/SHProdUser$/eddyayuk/generate_dashboard20_html.py
[INFO] Using default configuration

================================================================================
Q4 PRODUCTION DASHBOARD - CORRECTED FORMULA
================================================================================

[INFO] Current date: 2025-12-16 12:19:10
[INFO] Current work week: WW202550
[INFO] Deadline: 2026-03-06 06:00 PM
[INFO] Loading data files...
[OK] Loaded 4151 lineview records
[OK] Loaded 8526 lot records
[INFO] Configuration:
   BE LSB Operation: 9812
   Commit LSB Operation: 175084
   Target: SD104 by 2026-03-06 06:00 PM

[INFO] Querying database (PROD lots only)...
\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py:1430: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  shift_df = pd.read_sql(current_shift_sql, db)
\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py:1446: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  qdf = pd.read_sql(quarter_sql, db)
\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py:1472: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  last_24h_df = pd.read_sql(last_24h_sql, db)
[INFO] Tracking commit section (Op 175084)...
\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py:555: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  commit_shift_df = pd.read_sql(commit_shift_sql, db)
\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py:571: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  commit_24h_df = pd.read_sql(commit_24h_sql, db)
\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py:586: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  commit_quarter_df = pd.read_sql(commit_quarter_sql, db)
[OK] Commit section (Op 175084): Shift=300.0, 24h=862.0, Quarter=8,344.0
[OK] Database queries complete
[INFO] Analyzing weekly trends...
\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py:292: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  week_df = pd.read_sql(week_sql, db)
[DEBUG] Week 2025-12-06 to 2025-12-13 = WW49, Ships: 7,445
\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py:292: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  week_df = pd.read_sql(week_sql, db)
[DEBUG] Week 2025-12-13 to 2025-12-16 = WW50, Ships: 2,233
[INFO] Analyzing quarterly CT impact...
\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py:193: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  shipped_lots = pd.read_sql(shipped_lots_sql, db)
[INFO] Analyzing CT impact across 713 PROD lots (active + shipped)
\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py:213: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  lot_ct = pd.read_sql(lot_ct_sql, db)
[OK] Found 14 operations over CT goal

[ERROR] 'PP_mod'
Traceback (most recent call last):
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\pandas\core\indexes\base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'PP_mod'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "\\shuser-prod.intel.com\SHProdUser$\eddyayuk\generate_dashboard20_html.py", line 1536, in main
    quarter_bump_inv = quarter_remaining - df_q.query("PP_W == 0").head(1)["PP_mod"].values[0]
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\pandas\core\frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\eddyayuk\My Programs\SQLPathFinder3\Python3\lib\site-packages\pandas\core\indexes\base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'PP_mod'
PS C:\Users\eddyayuk> 
